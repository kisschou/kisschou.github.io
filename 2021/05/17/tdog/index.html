<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>关于一个叫做tdog的小东西 | 男孩的迷宫</title><meta name="keywords" content="golang"><meta name="author" content="Kisschou"><meta name="copyright" content="Kisschou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一个简易的golang框架，也可以算是一个简易的golang脚手架.">
<meta property="og:type" content="article">
<meta property="og:title" content="关于一个叫做tdog的小东西">
<meta property="og:url" content="https://kisschou.github.io/2021/05/17/tdog/index.html">
<meta property="og:site_name" content="男孩的迷宫">
<meta property="og:description" content="一个简易的golang框架，也可以算是一个简易的golang脚手架.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940">
<meta property="article:published_time" content="2021-05-17T19:18:51.000Z">
<meta property="article:modified_time" content="2021-05-18T03:58:17.591Z">
<meta property="article:author" content="Kisschou">
<meta property="article:tag" content="golang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://kisschou.github.io/2021/05/17/tdog/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '关于一个叫做tdog的小东西',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-05-18 11:58:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://avatars.githubusercontent.com/u/996082?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=650&amp;w=940')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">男孩的迷宫</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">关于一个叫做tdog的小东西</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-17T19:18:51.000Z" title="发表于 2021-05-18 03:18:51">2021-05-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-05-18T03:58:17.591Z" title="更新于 2021-05-18 11:58:17">2021-05-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%88%91%E7%9A%84%E5%B0%8F%E7%8E%A9%E6%84%8F/">我的小玩意</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="关于一个叫做tdog的小东西"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/github/go-mod/go-version/kisschou/tdog?color=green&style=flat-square" alt="go"> <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/github/last-commit/kisschou/tdog" alt="commit"> <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/github/license/kisschou/tdog?color=green" alt="licence"> <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://img.shields.io/badge/kisschou-tdog-green" alt="tdog"></p>
<p>仅仅是一个微笑的开始.</p>
<br />

<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><a href="/2021/05/17/tdog-en/">English Docs</a></p>
<p>这是我所有的golang项目的核心包。也许这个项目可以算是一个框架，但是我更觉得它是一个脚手架。</p>
<p><code>Restful-Server</code> 模块是参考 <code>GIN</code> 做的. 也许它不是很强大, 但是也基本上可以算是完善。</p>
<br />

<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先你必须安装golang和golang的开发环境。</p>
<ol>
<li>通过go的命令获取它:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get -u github.com/kisschou/tdog</span><br></pre></td></tr></table></figure></li>
<li>在你的项目中导入它:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &quot;github.com/kisschou/tdog&quot;</span><br></pre></td></tr></table></figure></li>
</ol>
<br />

<h2 id="快速使用"><a href="#快速使用" class="headerlink" title="快速使用"></a>快速使用</h2><h4 id="用来起服务"><a href="#用来起服务" class="headerlink" title="用来起服务:"></a>用来起服务:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cat example.go</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := tdog.New()</span><br><span class="line"></span><br><span class="line">    r.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(httpUtil *tdog.HttpUtil)</span></span> &#123;</span><br><span class="line">        httpUtil.Res.JSON(http.StatusOK, tdog.H&#123;</span><br><span class="line">            <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Pong GET&quot;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run() <span class="comment">// Start server.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="当脚手架使用"><a href="#当脚手架使用" class="headerlink" title="当脚手架使用:"></a>当脚手架使用:</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    id, err := tdog.NewSnowflake(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>).Get()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatalln(err)</span><br><span class="line">    &#125;</span><br><span class="line">    log.Printf(id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br />

<h2 id="函数们"><a href="#函数们" class="headerlink" title="函数们"></a>函数们</h2><p>函数是身为脚手架的核心所在</p>
<br />

<h4 id="1-MySQL"><a href="#1-MySQL" class="headerlink" title="1. MySQL"></a>1. MySQL</h4><p>使用了<a target="_blank" rel="noopener" href="https://github.com/go-xorm/xorm">XORM</a>包，因此详细的函数可以参考它的<a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/go-xorm/xorm">文档</a>。</p>
<p>以下是我觉得要弄这么个模块的理由:</p>
<ul>
<li><p>当在一个框架中为相同的库使用相同的配置时，不需要一遍又一遍地写初始化</p>
</li>
<li><p>制作了一个简单的链接池，初始化引擎配置自动加载，提高了可重用性</p>
</li>
</ul>
<br />

<h5 id="1-1-结构"><a href="#1-1-结构" class="headerlink" title="1.1 结构"></a>1.1 结构</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mySql <span class="keyword">struct</span> &#123;</span><br><span class="line">	engineList <span class="keyword">map</span>[<span class="keyword">string</span>]*xorm.Engine <span class="comment">// 引擎池</span></span><br><span class="line">	Engine     *xorm.Engine            <span class="comment">// 当前引擎</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MySqlConf <span class="keyword">struct</span> &#123;</span><br><span class="line">	engine       <span class="keyword">string</span></span><br><span class="line">	Host         <span class="keyword">string</span></span><br><span class="line">	Port         <span class="keyword">string</span></span><br><span class="line">	User         <span class="keyword">string</span></span><br><span class="line">	Pass         <span class="keyword">string</span></span><br><span class="line">	Db           <span class="keyword">string</span></span><br><span class="line">	Charset      <span class="keyword">string</span></span><br><span class="line">	Prefix       <span class="keyword">string</span></span><br><span class="line">	dsn          <span class="keyword">string</span></span><br><span class="line">	Debug        <span class="keyword">bool</span></span><br><span class="line">	MaxIdleConns <span class="keyword">int</span></span><br><span class="line">	MaxOpenConns <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MySql 配置说明:</p>
<table>
<thead>
<tr>
<th>field</th>
<th>type</th>
<th>desc</th>
</tr>
</thead>
<tbody><tr>
<td>engine</td>
<td>string</td>
<td>操作数据库引擎</td>
</tr>
<tr>
<td>Host</td>
<td>string</td>
<td>数据库连接地址</td>
</tr>
<tr>
<td>Port</td>
<td>string</td>
<td>数据库连接端口</td>
</tr>
<tr>
<td>User</td>
<td>string</td>
<td>数据库连接的帐户</td>
</tr>
<tr>
<td>Pass</td>
<td>string</td>
<td>数据库连接密码</td>
</tr>
<tr>
<td>Db</td>
<td>string</td>
<td>数据库连接数据库</td>
</tr>
<tr>
<td>Charset</td>
<td>string</td>
<td>数据库使用的字符集</td>
</tr>
<tr>
<td>Prefix</td>
<td>string</td>
<td>数据库中表的前缀</td>
</tr>
<tr>
<td>dsn</td>
<td>string</td>
<td>数据源</td>
</tr>
<tr>
<td>Debug</td>
<td>bool</td>
<td>是否开启调试模式</td>
</tr>
<tr>
<td>MaxIdleConns</td>
<td>int</td>
<td>线程池的最大空闲连接数</td>
</tr>
<tr>
<td>MaxOpenConns</td>
<td>int</td>
<td>线程池打开的最大连接数</td>
</tr>
</tbody></table>
<blockquote>
<p>自定义MySQL配置文件时，只需要设置以下值即可:</p>
<ul>
<li>Host</li>
<li>Port</li>
<li>User</li>
<li>Pass</li>
<li>Db</li>
<li>Charset</li>
<li>Prefix</li>
<li>Debug</li>
<li>MaxIdleConns</li>
<li>MaxOpenConns</li>
</ul>
</blockquote>
<p>如果从配置文件导入数据库连接，将使用TOML样式化配置文件。配置项如下:</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ cat database.toml</span><br><span class="line"><span class="comment">## 是否开启调试模式</span></span><br><span class="line"><span class="attr">debug</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># master表</span></span><br><span class="line"><span class="section">[master]</span> <span class="comment"># 引擎标签名</span></span><br><span class="line"><span class="attr">host</span> = <span class="string">&quot;127.0.0.1&quot;</span> <span class="comment"># 连接地址</span></span><br><span class="line"><span class="attr">port</span> = <span class="string">&quot;3306&quot;</span> <span class="comment"># 连接端口</span></span><br><span class="line"><span class="attr">user</span> = <span class="string">&quot;root&quot;</span> <span class="comment"># 连接账户</span></span><br><span class="line"><span class="attr">pass</span> = <span class="string">&quot;root&quot;</span> <span class="comment"># 连接密码</span></span><br><span class="line"><span class="attr">db</span> = <span class="string">&quot;test_db&quot;</span> <span class="comment"># 连接数据库</span></span><br><span class="line"><span class="attr">charset</span> = <span class="string">&quot;utf8mb4&quot;</span> <span class="comment"># 字符集</span></span><br><span class="line"><span class="attr">prefix</span> = <span class="string">&quot;&quot;</span> <span class="comment"># 表前缀</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只读表</span></span><br><span class="line"><span class="section">[master_read]</span> <span class="comment"># 引擎标签名</span></span><br><span class="line"><span class="attr">host</span> = <span class="string">&quot;127.0.0.1&quot;</span> <span class="comment"># 连接地址</span></span><br><span class="line"><span class="attr">port</span> = <span class="string">&quot;3306&quot;</span> <span class="comment"># 连接端口</span></span><br><span class="line"><span class="attr">user</span> = <span class="string">&quot;root&quot;</span> <span class="comment"># 连接账户</span></span><br><span class="line"><span class="attr">pass</span> = <span class="string">&quot;root&quot;</span> <span class="comment"># 连接密码</span></span><br><span class="line"><span class="attr">db</span> = <span class="string">&quot;test_db&quot;</span> <span class="comment"># 连接数据库</span></span><br><span class="line"><span class="attr">charset</span> = <span class="string">&quot;utf8mb4&quot;</span> <span class="comment"># 字符集</span></span><br><span class="line"><span class="attr">prefix</span> = <span class="string">&quot;&quot;</span> <span class="comment"># 表前缀</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>请参阅配置部分，了解如何从toml文件获得它们。</p>
</blockquote>
<br />

<h5 id="1-2-NewMySQL-mySql"><a href="#1-2-NewMySQL-mySql" class="headerlink" title="1.2 NewMySQL() *mySql"></a>1.2 NewMySQL() *mySql</h5><p>这个函数用于初始化mySql结构，这是一切的起点和核心。</p>
<p>导入tdog之后，这个函数被用作 <code>tdog.NewMySQL()</code>。</p>
<br />

<h5 id="1-3-mySql-Change-name-string-xorm-Engine"><a href="#1-3-mySql-Change-name-string-xorm-Engine" class="headerlink" title="1.3 (*mySql) Change(name string) *xorm.Engine"></a>1.3 (*mySql) Change(name string) *xorm.Engine</h5><p>使用标记名切换当前数据库引擎。</p>
<p>如果标签名在引擎组中不存在，则转到配置文件中获取对应的配置，构建完成后返回引擎。</p>
<br />

<h5 id="1-4-mySql-New-name-string-conf-MySqlConf-xorm-Engine"><a href="#1-4-mySql-New-name-string-conf-MySqlConf-xorm-Engine" class="headerlink" title="1.4 (*mySql) New(name string, conf *MySqlConf) *xorm.Engine"></a>1.4 (*mySql) New(name string, conf *MySqlConf) *xorm.Engine</h5><p>您可以使用此函数通过自定义配置文件生成引擎。</p>
<br />

<h5 id="1-5-Example"><a href="#1-5-Example" class="headerlink" title="1.5 Example"></a>1.5 Example</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line"></span><br><span class="line">engine := tdog.NewMySQL().Engine <span class="comment">// 使用默认配置初始化mysql引擎。</span></span><br><span class="line"></span><br><span class="line">tab1Impl := <span class="built_in">new</span>(tab1) <span class="comment">// init table struct.</span></span><br><span class="line">result, err := engine.Where(<span class="string">&quot;id=?&quot;</span>, <span class="number">1</span>).Get(tab1Impl)</span><br><span class="line"><span class="comment">// Query SQL: SELECT * FROM tab1 WHERE id = 1 LIMIT 1;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 关于事物</span></span><br><span class="line">trans := engine.Session() <span class="comment">// 初始化一个新事务.</span></span><br><span class="line"><span class="keyword">defer</span> trans.Close()</span><br><span class="line">affected, err := trans.InsertMulti([]*tab1)</span><br><span class="line"><span class="keyword">if</span> affected &lt; <span class="number">1</span> &amp;&amp; err != <span class="literal">nil</span> &#123;</span><br><span class="line">	trans.Rollback()</span><br><span class="line">&#125;</span><br><span class="line">trans.Commit()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>更多orm操作方法，请参考<a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/go-xorm/xorm">文档</a>。</p>
</blockquote>
<br />

<h4 id="2-Redis"><a href="#2-Redis" class="headerlink" title="2. Redis"></a>2. Redis</h4><p>使用了<a target="_blank" rel="noopener" href="https://github.com/go-redis/redis">go-redis</a>包，所以详细的功能可以参考它的<a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/go-redis/redis/v8">文档</a>。</p>
<p>以下是我觉得要弄这么个模块的理由:</p>
<ul>
<li><p>当在一个框架中为相同的库使用相同的配置时，不需要一遍又一遍地写初始化</p>
</li>
<li><p>制作了一个简单的链接池，初始化引擎配置自动加载，提高了可重用性</p>
</li>
</ul>
<br />

<h5 id="1-1-结构-1"><a href="#1-1-结构-1" class="headerlink" title="1.1 结构"></a>1.1 结构</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> redisModel <span class="keyword">struct</span> &#123;</span><br><span class="line">	engineList <span class="keyword">map</span>[<span class="keyword">string</span>]*redisImpl.Client <span class="comment">// 引擎池</span></span><br><span class="line">	Engine     *redisImpl.Client            <span class="comment">// 当前引擎</span></span><br><span class="line">	db         <span class="keyword">int</span>                          <span class="comment">// 当前连接的db</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果从配置文件导入redis连接，配置文件将使用TOML进行样式设置。配置项如下:</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cat cache.toml</span><br><span class="line"><span class="section">[master]</span></span><br><span class="line"><span class="attr">host</span> = <span class="string">&quot;127.0.0.1&quot;</span> <span class="comment"># 连接地址</span></span><br><span class="line"><span class="attr">port</span> = <span class="string">&quot;6379&quot;</span> <span class="comment"># 连接短裤</span></span><br><span class="line"><span class="attr">pass</span> = <span class="string">&quot;&quot;</span> <span class="comment"># 连接密码</span></span><br><span class="line"><span class="attr">pool_size</span> = <span class="number">10</span> <span class="comment"># 连接数</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>请参阅配置部分，了解如何从toml文件获得它们。</p>
</blockquote>
<br />

<h5 id="1-2-函数和使用"><a href="#1-2-函数和使用" class="headerlink" title="1.2 函数和使用"></a>1.2 函数和使用</h5><br />

<h6 id="1-2-1-NewRedis-redisModel"><a href="#1-2-1-NewRedis-redisModel" class="headerlink" title="1.2.1 NewRedis() *redisModel"></a>1.2.1 NewRedis() *redisModel</h6><p>这个函数用于初始化reddisModel结构，它是所有内容的起点和核心。</p>
<p>在导入tdog之后，这个函数被用作 <code>tdog.NewRedis()</code></p>
<br />

<h6 id="1-2-2-redisModel-Change-name-string-redisImpl-Client"><a href="#1-2-2-redisModel-Change-name-string-redisImpl-Client" class="headerlink" title="1.2.2 (*redisModel) Change(name string) *redisImpl.Client"></a>1.2.2 (*redisModel) Change(name string) *redisImpl.Client</h6><p>使用标签名称切换当前的redis引擎。</p>
<p>如果标签名在引擎组中不存在，则转到配置文件中获取对应的配置，构建完成后返回引擎。</p>
<br />

<h6 id="1-2-3-redisModel-New-name-host-port-pass-string-poolSize-int-redisImpl-Client"><a href="#1-2-3-redisModel-New-name-host-port-pass-string-poolSize-int-redisImpl-Client" class="headerlink" title="1.2.3 (*redisModel) New(name, host, port, pass string, poolSize int) *redisImpl.Client"></a>1.2.3 (*redisModel) New(name, host, port, pass string, poolSize int) *redisImpl.Client</h6><p>您可以使用此函数通过自定义配置文件生成引擎。</p>
<p>传递参数描述:</p>
<table>
<thead>
<tr>
<th>param</th>
<th>type</th>
<th>desc</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>string</td>
<td>设置连接名称</td>
</tr>
<tr>
<td>host</td>
<td>string</td>
<td>设置连接主机</td>
</tr>
<tr>
<td>port</td>
<td>string</td>
<td>设置连接端口</td>
</tr>
<tr>
<td>pass</td>
<td>string</td>
<td>设置连接密码</td>
</tr>
<tr>
<td>poolSize</td>
<td>int</td>
<td>设置连接池大小</td>
</tr>
</tbody></table>
<br />

<h6 id="1-2-4-redisModel-Db-index-int-redisImpl-Client"><a href="#1-2-4-redisModel-Db-index-int-redisImpl-Client" class="headerlink" title="1.2.4 (*redisModel) Db(index int) *redisImpl.Client"></a>1.2.4 (*redisModel) Db(index int) *redisImpl.Client</h6><p>接受一个索引来切换当前引擎使用的库。</p>
<br />

<h5 id="1-3-示例"><a href="#1-3-示例" class="headerlink" title="1.3 示例"></a>1.3 示例</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line"></span><br><span class="line">engine := tdog.NewRedis().Engine <span class="comment">// 初始化redis引擎使用默认配置</span></span><br><span class="line">result, err := engine.SetNX(tdog.Ctx, <span class="string">&quot;test:key&quot;</span>, <span class="string">&quot;Hello World&quot;</span>, time.Duration(<span class="number">60</span>)*time.Second).Result() <span class="comment">// 设置键</span></span><br><span class="line">engine.Get(tdog.Ctx, <span class="string">&quot;test:key&quot;</span>).String() <span class="comment">// 获取键</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>更多orm操作方法，请参考<a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/go-xorm/xorm">文档</a>。</p>
</blockquote>
<br />

<h4 id="3-工具"><a href="#3-工具" class="headerlink" title="3. 工具"></a>3. 工具</h4><p>我认为有些脚手架是很常见的。目前只要实现，不追求太多的性能，局限于强类型，很多地方编写非常繁琐和不完整的支持，包会不断完善、扩展。</p>
<br />

<h5 id="3-1-结构"><a href="#3-1-结构" class="headerlink" title="3.1 结构"></a>3.1 结构</h5><p>这个结构没什么特别的值得说的。</p>
<br />

<h5 id="3-2-函数和使用"><a href="#3-2-函数和使用" class="headerlink" title="3.2 函数和使用"></a>3.2 函数和使用</h5><p>这也许是脚手架的职责。</p>
<br />

<h6 id="3-2-1-NewUtil-util"><a href="#3-2-1-NewUtil-util" class="headerlink" title="3.2.1 NewUtil() *util"></a>3.2.1 NewUtil() *util</h6><p>这个函数用于初始化util结构，它是所有内容的起点和核心。</p>
<p>在导入tdog之后，这个函数被用作 <code>tdog.NewUtil()</code></p>
<br />

<h6 id="3-2-2-util-GetFilesBySuffix-filePath-string-suffix-string-files-string-err-error"><a href="#3-2-2-util-GetFilesBySuffix-filePath-string-suffix-string-files-string-err-error" class="headerlink" title="3.2.2 (*util) GetFilesBySuffix(filePath string, suffix string) (files []string, err error)"></a>3.2.2 (*util) GetFilesBySuffix(filePath string, suffix string) (files []string, err error)</h6><p>从指定路径获取所有指定后缀的文件名。</p>
<br />

<h6 id="3-2-3-util-FileExists-path-string-bool"><a href="#3-2-3-util-FileExists-path-string-bool" class="headerlink" title="3.2.3 (*util) FileExists(path string) bool"></a>3.2.3 (*util) FileExists(path string) bool</h6><p>检查文件是否存在。</p>
<br />

<h6 id="3-2-4-util-IsDir-path-string-bool"><a href="#3-2-4-util-IsDir-path-string-bool" class="headerlink" title="3.2.4 (*util) IsDir(path string) bool"></a>3.2.4 (*util) IsDir(path string) bool</h6><p>检查它是否是一个目录。</p>
<br />

<h6 id="3-2-5-util-IsFile-path-string"><a href="#3-2-5-util-IsFile-path-string" class="headerlink" title="3.2.5 (*util) IsFile(path string)"></a>3.2.5 (*util) IsFile(path string)</h6><p>检查它是否是一个文件。</p>
<br />

<h6 id="3-2-6-util-DirExistsAndCreate-path-string"><a href="#3-2-6-util-DirExistsAndCreate-path-string" class="headerlink" title="3.2.6 (*util) DirExistsAndCreate(path string)"></a>3.2.6 (*util) DirExistsAndCreate(path string)</h6><p>检查目录是否存在，如果不存在则创建。</p>
<br />

<h6 id="3-2-7-util-RandomStr-length-int-randType-…int-string"><a href="#3-2-7-util-RandomStr-length-int-randType-…int-string" class="headerlink" title="3.2.7 (*util) RandomStr(length int, randType …int) string"></a>3.2.7 (*util) RandomStr(length int, randType …int) string</h6><p>生成指定类型和长度的字符串。</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>length</td>
<td>int</td>
<td>指定生成的字符串的长度</td>
</tr>
<tr>
<td>randType</td>
<td>…int</td>
<td>随机指定类型。可选，多选项，可选参数:1添加数字2添加小写字母3添加大写字母，默认为1。</td>
</tr>
</tbody></table>
<br />

<h6 id="3-2-8-util-RandInt64-min-max-int64-int64"><a href="#3-2-8-util-RandInt64-min-max-int64-int64" class="headerlink" title="3.2.8 (*util) RandInt64(min, max int64) int64"></a>3.2.8 (*util) RandInt64(min, max int64) int64</h6><p>指定要生成类型为int64的随机数的范围。</p>
<br />

<h6 id="3-2-9-util-InArray-dataType-string-input-needle-interface-bool"><a href="#3-2-9-util-InArray-dataType-string-input-needle-interface-bool" class="headerlink" title="3.2.9 (*util) InArray(dataType string, input, needle interface{}) bool"></a>3.2.9 (*util) InArray(dataType string, input, needle interface{}) bool</h6><p>确定数组中是否存在一个值。</p>
<p>参数描述:</p>
<ul>
<li><code>dataType</code> : needle的类型，可选项:<ul>
<li>[]string</li>
<li>[]int</li>
<li>[]int64</li>
<li>map[string]string</li>
<li>map[string]int</li>
<li>map[string]int64</li>
</ul>
</li>
<li><code>input</code> : 输入值，该类型与<code>dataType</code>的<code>value</code>类型相同。</li>
<li><code>needle</code> : 检索集，此类型等于 <code>dataType</code> 。</li>
</ul>
<br />

<h6 id="3-2-10-util-Isset-dataType-string-input-needle-interface-bool"><a href="#3-2-10-util-Isset-dataType-string-input-needle-interface-bool" class="headerlink" title="3.2.10 (*util) Isset(dataType string, input, needle interface{}) bool"></a>3.2.10 (*util) Isset(dataType string, input, needle interface{}) bool</h6><p>确定数组中是否存在键。</p>
<p>参数描述:</p>
<ul>
<li><code>dataType</code> : needle的类型，可选项:<ul>
<li>[]string</li>
<li>[]int</li>
<li>[]int64</li>
<li>[]interface{}</li>
<li>map[string]string</li>
<li>map[string]int</li>
<li>map[string]int64</li>
<li>map[string]interface{}</li>
</ul>
</li>
<li><code>input</code> : 输入值，此类型等于相同的 <code>key</code> 类型的 <code>dataType</code>。</li>
<li><code>needle</code> : 检索集，此类型等于 <code>dataType</code>。</li>
</ul>
<br />

<h6 id="3-2-11-util-Empty-dataType-string-input-needle-interface-bool"><a href="#3-2-11-util-Empty-dataType-string-input-needle-interface-bool" class="headerlink" title="3.2.11 (*util) Empty(dataType string, input, needle interface{}) bool"></a>3.2.11 (*util) Empty(dataType string, input, needle interface{}) bool</h6><p>如果数组中指定的键值为空，则该值大于0。</p>
<p>参数描述:</p>
<ul>
<li><code>dataType</code> : needle的类型，可选项:<ul>
<li>[]string</li>
<li>[]int</li>
<li>[]int64</li>
<li>map[string]string</li>
<li>map[string]int</li>
<li>map[string]int64</li>
</ul>
</li>
<li><code>input</code> : 输入值，此类型等于相同的 <code>key</code> 类型的 <code>dataType</code>。</li>
<li><code>needle</code> : 检索集，此类型等于 <code>dataType</code>。</li>
</ul>
<br />

<h6 id="3-2-12-util-ArrayUnique-dataType-string-input-interface-interface"><a href="#3-2-12-util-ArrayUnique-dataType-string-input-interface-interface" class="headerlink" title="3.2.12 (*util) ArrayUnique(dataType string, input interface{}) interface{}"></a>3.2.12 (*util) ArrayUnique(dataType string, input interface{}) interface{}</h6><p>数组删除重复的键。</p>
<p>参数描述:</p>
<ul>
<li><code>dataType</code> :  input的类型，可选项:<ul>
<li>[]string</li>
<li>[]int</li>
<li>[]int64</li>
<li>[]interface{}</li>
<li>map[string]string</li>
<li>map[string]int</li>
<li>map[string]int64</li>
<li>map[string]interface{}</li>
</ul>
</li>
<li><code>input</code> : 需要合并的数组, 此类型等于 <code>dataType</code>。</li>
</ul>
<br />

<h6 id="3-2-13-util-ArrayMerge-dataType-string-list-…interface-interface"><a href="#3-2-13-util-ArrayMerge-dataType-string-list-…interface-interface" class="headerlink" title="3.2.13 (*util) ArrayMerge(dataType string, list …interface{}) interface{}"></a>3.2.13 (*util) ArrayMerge(dataType string, list …interface{}) interface{}</h6><p>合并多个数组。</p>
<blockquote>
<p>注意，这些数组必须是相同的类型。</p>
</blockquote>
<p>参数描述:</p>
<ul>
<li><code>dataType</code> : list的类型，可选项:<ul>
<li>[]string</li>
<li>[]int</li>
<li>[]interface{}</li>
<li>map[string]string</li>
<li>map[string]int</li>
<li>map[string]interface{}</li>
</ul>
</li>
<li><code>list</code> : 两个或两个以上相同类型的数组。</li>
</ul>
<br />

<h6 id="3-2-14-util-Remove-dataType-string-slice-interface-index-int-interface"><a href="#3-2-14-util-Remove-dataType-string-slice-interface-index-int-interface" class="headerlink" title="3.2.14 (*util) Remove(dataType string, slice interface{}, index int) interface{}"></a>3.2.14 (*util) Remove(dataType string, slice interface{}, index int) interface{}</h6><p>编写这个函数是因为在Go中，似乎只有map删除指定的键，而没有slice删除指定的索引的。</p>
<p>参数描述:</p>
<ul>
<li><code>dataType</code> : slice的类型，可选项:<ul>
<li>[]string</li>
<li>[]int</li>
<li>[]int64</li>
<li>[]interface{}</li>
</ul>
</li>
<li><code>slice</code> : 要处理的切片，该类型等于 <code>dataType</code>。</li>
<li><code>index</code> : 要删除的索引.</li>
</ul>
<br />

<h6 id="3-2-15-util-VerifyEmail-email-string-bool"><a href="#3-2-15-util-VerifyEmail-email-string-bool" class="headerlink" title="3.2.15 (*util) VerifyEmail(email string) bool"></a>3.2.15 (*util) VerifyEmail(email string) bool</h6><p>检查邮箱格式是否正确。</p>
<br />

<h6 id="3-2-16-util-VerifyPhone-phone-string-bool"><a href="#3-2-16-util-VerifyPhone-phone-string-bool" class="headerlink" title="3.2.16 (*util) VerifyPhone(phone string) bool"></a>3.2.16 (*util) VerifyPhone(phone string) bool</h6><p>检查电话号码格式是否正确。</p>
<blockquote>
<p>目前只支持中国大陆地区的手机号码验证。</p>
</blockquote>
<br />

<h6 id="3-2-17-util-VerifyDate-input-string-bool"><a href="#3-2-17-util-VerifyDate-input-string-bool" class="headerlink" title="3.2.17 (*util) VerifyDate(input string) bool"></a>3.2.17 (*util) VerifyDate(input string) bool</h6><p>检查日期格式是否正确。格式: YYYY-MM-DD.</p>
<br />

<h6 id="3-2-18-util-VerifyDateTime-input-string-bool"><a href="#3-2-18-util-VerifyDateTime-input-string-bool" class="headerlink" title="3.2.18 (*util) VerifyDateTime(input string) bool"></a>3.2.18 (*util) VerifyDateTime(input string) bool</h6><p>检查日期和时间格式是否正确。格式: YYYY-MM-DD HH:mm:ss.</p>
<br />

<h6 id="3-2-19-util-GetMachineId-int64"><a href="#3-2-19-util-GetMachineId-int64" class="headerlink" title="3.2.19 (*util) GetMachineId() int64"></a>3.2.19 (*util) GetMachineId() int64</h6><p>获取设备号, 通过网卡IPv4生成。</p>
<br />

<h6 id="3-2-20-util-StructToMap-obj-interface-map-string-interface"><a href="#3-2-20-util-StructToMap-obj-interface-map-string-interface" class="headerlink" title="3.2.20 (*util) StructToMap(obj interface{}) map[string]interface{}"></a>3.2.20 (*util) StructToMap(obj interface{}) map[string]interface{}</h6><p>结构转换为map。</p>
<p>由于一些未知的问题，往往导致恐慌，所以加入了recover()，虽然恢复了，但仍然没有转换成功。</p>
<p>这是一个需要进一步改进的函数。</p>
<br />

<h6 id="3-2-21-util-UrlSplit-url-string-protocol-domain-string-port-int"><a href="#3-2-21-util-UrlSplit-url-string-protocol-domain-string-port-int" class="headerlink" title="3.2.21 (*util) UrlSplit(url string) (protocol, domain string, port int)"></a>3.2.21 (*util) UrlSplit(url string) (protocol, domain string, port int)</h6><p>Url分解。</p>
<br />

<h6 id="3-2-22-util-UrlJoint-protocol-domain-string-port-int-url-string"><a href="#3-2-22-util-UrlJoint-protocol-domain-string-port-int-url-string" class="headerlink" title="3.2.22 (*util) UrlJoint(protocol, domain string, port int) (url string)"></a>3.2.22 (*util) UrlJoint(protocol, domain string, port int) (url string)</h6><p>Url拼接。</p>
<br />

<h6 id="3-2-23-util-SnakeString-s-string-string"><a href="#3-2-23-util-SnakeString-s-string-string" class="headerlink" title="3.2.23 (*util) SnakeString(s string) string"></a>3.2.23 (*util) SnakeString(s string) string</h6><p>驼峰转蛇形。</p>
<br />

<h6 id="3-2-24-util-CamelString-s-string-string"><a href="#3-2-24-util-CamelString-s-string-string" class="headerlink" title="3.2.24 (*util) CamelString(s string) string"></a>3.2.24 (*util) CamelString(s string) string</h6><p>蛇形转驼峰。</p>
<br />

<h6 id="3-2-25-util-UcFirst-s-string-string"><a href="#3-2-25-util-UcFirst-s-string-string" class="headerlink" title="3.2.25 (*util) UcFirst(s string) string"></a>3.2.25 (*util) UcFirst(s string) string</h6><p>使首字母大写。</p>
<br />

<h6 id="3-2-26-util-checkPortAlived-port-int-bool"><a href="#3-2-26-util-checkPortAlived-port-int-bool" class="headerlink" title="3.2.26 (*util) checkPortAlived(port int) bool"></a>3.2.26 (*util) checkPortAlived(port int) bool</h6><p>检查端口是否已被占用。</p>
<br />

<h6 id="3-2-26-util-GetPidByPort-port-int-int"><a href="#3-2-26-util-GetPidByPort-port-int-int" class="headerlink" title="3.2.26 (*util) GetPidByPort(port int) int"></a>3.2.26 (*util) GetPidByPort(port int) int</h6><p>从端口号获取PID。</p>
<blockquote>
<p>不是总是可用的。比如协程就不可用。</p>
</blockquote>
<br />

<h6 id="3-2-27-util-SetEnv-key-interface-value-string-error"><a href="#3-2-27-util-SetEnv-key-interface-value-string-error" class="headerlink" title="3.2.27 (*util) SetEnv(key interface{}, value string) error"></a>3.2.27 (*util) SetEnv(key interface{}, value string) error</h6><p>将指定的键值写入环境变量。</p>
<p>参数描述:</p>
<ul>
<li><p><code>key</code> : 密钥名称只能为string或map[string]string。</p>
<ul>
<li>如果 <code>string</code> : 对应作为键值传入的值。</li>
<li>如果 <code>map[string]string</code> : 忽略传入的值并批量设置map中的键值。</li>
</ul>
</li>
<li><p><code>value</code> : 对应的值，当键为map时可以为 <code>empty</code>。</p>
</li>
</ul>
<br />

<h6 id="3-2-28-util-GetEnv-keys-…string-map-string-string"><a href="#3-2-28-util-GetEnv-keys-…string-map-string-string" class="headerlink" title="3.2.28 (*util) GetEnv(keys …string) map[string]string"></a>3.2.28 (*util) GetEnv(keys …string) map[string]string</h6><p>从环境变量获取一个或多个键值。</p>
<p>因此，输入可以是一个或多个，返回的映射对应于输入键，值对应于响应检索到的值。</p>
<br />

<h6 id="3-2-29-Recover"><a href="#3-2-29-Recover" class="headerlink" title="3.2.29 Recover()"></a>3.2.29 Recover()</h6><p>从恐慌中走出来，在日志中写下恐慌的原因。</p>
<p>通常用 <code>defer</code>。</p>
<br />

<h6 id="3-2-30-Monitor-err-error"><a href="#3-2-30-Monitor-err-error" class="headerlink" title="3.2.30 Monitor() (err error)"></a>3.2.30 Monitor() (err error)</h6><p>基本检查，检查Redis和MySQL是否可以连接等。</p>
<p>通常在启动脚本的地方运行脚本，以确保正在运行的脚本不会因为这个附加问题而在某处出现错误。</p>
<br />

<h5 id="3-3-示例"><a href="#3-3-示例" class="headerlink" title="3.3 示例"></a>3.3 示例</h5><p>所有函数都可以在NewUtil之后直接使用。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line"></span><br><span class="line">util := tdog.NewUtil()</span><br><span class="line">res := util.RandomStr(<span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<br />

<h4 id="4-加密"><a href="#4-加密" class="headerlink" title="4. 加密"></a>4. 加密</h4><p>其实，封装就是一些简单的加密，只是有时候用了就不记得怎么写了，搭建的关键是容易使用。</p>
<br />

<h5 id="4-1-结构"><a href="#4-1-结构" class="headerlink" title="4.1 结构"></a>4.1 结构</h5><p>结构中没有什么需要介绍的。</p>
<br />

<h5 id="4-2-函数和使用"><a href="#4-2-函数和使用" class="headerlink" title="4.2 函数和使用"></a>4.2 函数和使用</h5><p>这些都是我发现相当常见的加密方法。</p>
<br />

<h6 id="4-2-1-NewCrypt-input-string-crypt"><a href="#4-2-1-NewCrypt-input-string-crypt" class="headerlink" title="4.2.1 NewCrypt(input string) *crypt"></a>4.2.1 NewCrypt(input string) *crypt</h6><p>这个函数用于初始化crypt结构，这是所有内容的起点和核心。</p>
<p>导入tdog后，此函数被用作 <code>tdog.NewCrypt(&quot;需要加密的字符串&quot;)</code></p>
<br />

<h6 id="4-2-2-crypt-Md5-string"><a href="#4-2-2-crypt-Md5-string" class="headerlink" title="4.2.2 (*crypt) Md5() string"></a>4.2.2 (*crypt) Md5() string</h6><p>返回MD5加密字符串。</p>
<br />

<h6 id="4-2-3-crypt-Sha1-string"><a href="#4-2-3-crypt-Sha1-string" class="headerlink" title="4.2.3 (*crypt) Sha1() string"></a>4.2.3 (*crypt) Sha1() string</h6><p>返回SHA1加密的字符串。</p>
<br />

<h6 id="4-2-4-crypt-Sha256-string"><a href="#4-2-4-crypt-Sha256-string" class="headerlink" title="4.2.4 (*crypt) Sha256() string"></a>4.2.4 (*crypt) Sha256() string</h6><p>返回SHA256加密的字符串。</p>
<br />

<h6 id="4-2-5-crypt-Sha512"><a href="#4-2-5-crypt-Sha512" class="headerlink" title="4.2.5 (*crypt) Sha512()"></a>4.2.5 (*crypt) Sha512()</h6><p>返回SHA512加密后的字符串。</p>
<br />

<h6 id="4-2-6-crypt-Crc32-string"><a href="#4-2-6-crypt-Crc32-string" class="headerlink" title="4.2.6 (*crypt) Crc32() string"></a>4.2.6 (*crypt) Crc32() string</h6><p>返回通过循环冗余校验处理的结果。</p>
<br />

<h6 id="4-2-7-crypt-Base64Encode-string"><a href="#4-2-7-crypt-Base64Encode-string" class="headerlink" title="4.2.7 (*crypt) Base64Encode() string"></a>4.2.7 (*crypt) Base64Encode() string</h6><p>使用Base64对数据进行加密，并返回加密结果。</p>
<br />

<h6 id="4-2-8-crypt-Base64Decode-string"><a href="#4-2-8-crypt-Base64Decode-string" class="headerlink" title="4.2.8 (*crypt) Base64Decode() string"></a>4.2.8 (*crypt) Base64Decode() string</h6><p>返回用Base64解密的数据。</p>
<br />

<h6 id="4-2-9-crypt-UrlBase64Encode-string"><a href="#4-2-9-crypt-UrlBase64Encode-string" class="headerlink" title="4.2.9 (*crypt) UrlBase64Encode() string"></a>4.2.9 (*crypt) UrlBase64Encode() string</h6><p>使用UrlBase64对数据进行加密并返回加密结果。</p>
<br />

<h6 id="4-2-10-crypt-UrlBase64Decode-string"><a href="#4-2-10-crypt-UrlBase64Decode-string" class="headerlink" title="4.2.10 (*crypt) UrlBase64Decode() string"></a>4.2.10 (*crypt) UrlBase64Decode() string</h6><p>返回在UrlBase64中解密的数据。</p>
<br />

<h6 id="4-2-11-crypt-Urlencode-string"><a href="#4-2-11-crypt-Urlencode-string" class="headerlink" title="4.2.11 (*crypt) Urlencode() string"></a>4.2.11 (*crypt) Urlencode() string</h6><p>使用Urlencode对数据进行加密并返回加密结果。</p>
<br />

<h6 id="4-2-12-crypt-Urldecode-string"><a href="#4-2-12-crypt-Urldecode-string" class="headerlink" title="4.2.12 (*crypt) Urldecode() string"></a>4.2.12 (*crypt) Urldecode() string</h6><p>返回用Urldecode解密的数据。</p>
<br />

<h6 id="4-2-13-crypt-BiuPwdNewBuilder-password-string-salt-string-newPassword-string"><a href="#4-2-13-crypt-BiuPwdNewBuilder-password-string-salt-string-newPassword-string" class="headerlink" title="4.2.13 (*crypt) BiuPwdNewBuilder(password string) (salt string, newPassword string)"></a>4.2.13 (*crypt) BiuPwdNewBuilder(password string) (salt string, newPassword string)</h6><p>一个名为Biushop的项目使用的原始加密方案使用随机盐、固定盐、MD5和SHA512加密传入数据，并返回用于加密的随机盐和加密结果。解密结果是不可逆的。</p>
<br />

<h6 id="4-2-14-crypt-BiuPwdBuilder-salt-string-password-string-newPassword-string"><a href="#4-2-14-crypt-BiuPwdBuilder-salt-string-password-string-newPassword-string" class="headerlink" title="4.2.14 (*crypt) BiuPwdBuilder(salt string, password string) (newPassword string)"></a>4.2.14 (*crypt) BiuPwdBuilder(salt string, password string) (newPassword string)</h6><p>这是对Biushop的补充，因为我不习惯Golang对可选参数的支持，而且我对参数的顺序有点着迷。</p>
<p>这种方法主要是通过传入的加密数据和随机加盐，生成加密结果。</p>
<br />

<h6 id="4-2-15-crypt-GenerateRsaKey-bits-int-publicKey-privateKey-string"><a href="#4-2-15-crypt-GenerateRsaKey-bits-int-publicKey-privateKey-string" class="headerlink" title="4.2.15 (*crypt) GenerateRsaKey(bits int) (publicKey, privateKey string)"></a>4.2.15 (*crypt) GenerateRsaKey(bits int) (publicKey, privateKey string)</h6><p>接收一个int来确定生成的RSA密钥的位数，并返回生成的公钥和私钥。</p>
<br />

<h6 id="4-2-16-crypt-RsaPubEncode-pubKey-string-string"><a href="#4-2-16-crypt-RsaPubEncode-pubKey-string-string" class="headerlink" title="4.2.16 (*crypt) RsaPubEncode(pubKey string) string"></a>4.2.16 (*crypt) RsaPubEncode(pubKey string) string</h6><p>接收传入的公钥并使用它RSA加密数据。</p>
<br />

<h6 id="4-2-17-crypt-RsaPriDecode-priKey-string-string"><a href="#4-2-17-crypt-RsaPriDecode-priKey-string-string" class="headerlink" title="4.2.17 (*crypt) RsaPriDecode(priKey string) string"></a>4.2.17 (*crypt) RsaPriDecode(priKey string) string</h6><p>接收传入的私钥并使用它RSA解密数据。</p>
<br />

<h6 id="4-2-18-crypt-RsaPriEncode-priKey-string-string"><a href="#4-2-18-crypt-RsaPriEncode-priKey-string-string" class="headerlink" title="4.2.18 (*crypt) RsaPriEncode(priKey string) string"></a>4.2.18 (*crypt) RsaPriEncode(priKey string) string</h6><p>接收传入的私钥并使用它RSA加密数据。</p>
<br />

<h6 id="4-2-19-crypt-RsaPubDecode-pubKey-string-string"><a href="#4-2-19-crypt-RsaPubDecode-pubKey-string-string" class="headerlink" title="4.2.19 (*crypt) RsaPubDecode(pubKey string) string"></a>4.2.19 (*crypt) RsaPubDecode(pubKey string) string</h6><p>接收传入的公钥，并使用它RSA解密数据。</p>
<br />

<h5 id="4-3-示例"><a href="#4-3-示例" class="headerlink" title="4.3 示例"></a>4.3 示例</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// md5</span></span><br><span class="line">encrypt := tdog.NewCrypt(<span class="string">&quot;inputStr&quot;</span>).Md5()</span><br><span class="line"></span><br><span class="line"><span class="comment">// RSA</span></span><br><span class="line">crypt := tdog.NewCrypt(<span class="string">&quot;inputStr&quot;</span>)</span><br><span class="line">publicKey, privateKey := crypt.GenerateRsaKey(<span class="number">20</span>)</span><br><span class="line">encrypt := crypt.RsaPubEncode(publicKey)</span><br><span class="line">decrypt := tdog.NewCrypt(encrypt).RsaPriDecode(privateKey)</span><br><span class="line"></span><br><span class="line">encrypt = tdog.NewCrypt(decrypt).RsaPriEncode(privateKey)</span><br><span class="line">decrypt = tdog.NewCrypt(encrypt).RsaPubDecode(publicKey)</span><br></pre></td></tr></table></figure>

<br />

<h4 id="5-Excel"><a href="#5-Excel" class="headerlink" title="5. Excel"></a>5. Excel</h4><p>使用<a target="_blank" rel="noopener" href="https://github.com/tealeg/xlsx">XLSX</a>包来做一个方便使用的Excel处理工具，因为不知道如何面对Excel的处理，所以只做一个简单的函数。</p>
<br />

<h5 id="5-1-函数和使用"><a href="#5-1-函数和使用" class="headerlink" title="5.1 函数和使用"></a>5.1 函数和使用</h5><br />

<h6 id="5-1-1-NewExcel-file-string-excel"><a href="#5-1-1-NewExcel-file-string-excel" class="headerlink" title="5.1.1 NewExcel(file string) *excel"></a>5.1.1 NewExcel(file string) *excel</h6><p>使用文件初始化Excel模块，该文件是一切的起点和核心。</p>
<p>注意:这里传递的文件必须包含路径。</p>
<br />

<h6 id="5-1-2-excel-Get-string"><a href="#5-1-2-excel-Get-string" class="headerlink" title="5.1.2 ( *excel) Get() [][][]string"></a>5.1.2 ( *excel) Get() [][][]string</h6><p>从文件中读取所有数据并返回它。</p>
<br />

<h6 id="5-1-3-excel-Open-excelImpl-xlsx-File"><a href="#5-1-3-excel-Open-excelImpl-xlsx-File" class="headerlink" title="5.1.3 (*excel) Open() (excelImpl *xlsx.File)"></a>5.1.3 (*excel) Open() (excelImpl *xlsx.File)</h6><p>返回Excel文件的操作控制器，具体操作功能请参考XLSX的详细教程。</p>
<br />

<h4 id="6-配置"><a href="#6-配置" class="headerlink" title="6. 配置"></a>6. 配置</h4><p>这是一个与<a target="_blank" rel="noopener" href="https://github.com/spf13/viper">viper</a>打包的配置文件获取工具。封装的原因是:</p>
<ul>
<li><p>项目的配置文件理论上属于同一类型，且存在于一个目录中，可以通过配置文件预设基本信息，避免每次使用配置文件时都需要手动设置路径和文件名的麻烦。</p>
</li>
<li><p>配置文件不能保存在同一个配置文件中。为了消除跨文件查询的需要，基于文件重建引擎的问题。</p>
</li>
<li><p>支持查询和输出一个或多个文件下的多个配置。</p>
</li>
</ul>
<br />

<h5 id="6-1-结构"><a href="#6-1-结构" class="headerlink" title="6.1 结构"></a>6.1 结构</h5><p>配置文件的写入需要满足toml配置文件的写入要求，一个目录下可以存放多个配置文件。</p>
<p>基本配置文件的 <code>app.toml</code>，它不一定存在，但它是第一个查询文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> tree ./config</span></span><br><span class="line"></span><br><span class="line">config/</span><br><span class="line">├── app.toml</span><br><span class="line">├── cache.toml</span><br><span class="line">├── database.toml</span><br><span class="line">├── error.toml</span><br><span class="line">└── ...</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat app.toml</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 产品名 string</span></span><br><span class="line">app_name = &quot;ServiceCenter&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务端口 string</span></span><br><span class="line">app_port = &quot;8002&quot;</span><br></pre></td></tr></table></figure>

<br />

<h5 id="6-2-函数和使用"><a href="#6-2-函数和使用" class="headerlink" title="6.2 函数和使用"></a>6.2 函数和使用</h5><p>首先，必须将配置文件的配置指定到env的交叉点。这可以使用 <code>Util</code> 模块下的 <code>SetEnv</code> 函数:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line"></span><br><span class="line">tdog.NewUtil().SetEnv(<span class="string">&quot;CONFIG_PATH&quot;</span>, <span class="string">&quot;/path/to/config/&quot;</span>)</span><br></pre></td></tr></table></figure>

<br />

<h6 id="6-2-1-NewConfig-config"><a href="#6-2-1-NewConfig-config" class="headerlink" title="6.2.1 NewConfig() *config"></a>6.2.1 NewConfig() *config</h6><p>用这个文件初始化一个 <code>config</code> 模块，它是所有事情的起点和核心。</p>
<br />

<h6 id="6-2-2-config-SetPath-path-string-config"><a href="#6-2-2-config-SetPath-path-string-config" class="headerlink" title="6.2.2 (*config) SetPath(path string) *config"></a>6.2.2 (*config) SetPath(path string) *config</h6><p>如果正在查询的配置文件不在设置的路径下，可以使用该函数临时修改查询路径。</p>
<br />

<h6 id="6-2-3-config-SetFile-name-string-config"><a href="#6-2-3-config-SetFile-name-string-config" class="headerlink" title="6.2.3 (*config) SetFile(name string) *config"></a>6.2.3 (*config) SetFile(name string) *config</h6><p>指定查询配置文件，即仅在该配置文件中查找配置。</p>
<p>一般使用相同文件批量查询和相同名称配置项查询。</p>
<br />

<h6 id="6-2-4-config-SetPrefix-prefix-string-config"><a href="#6-2-4-config-SetPrefix-prefix-string-config" class="headerlink" title="6.2.4 (*config) SetPrefix(prefix string) *config"></a>6.2.4 (*config) SetPrefix(prefix string) *config</h6><p>设置查询项的前缀。一般用于在同一处批量查询多个配置项。</p>
<br />

<h6 id="6-2-5-config-Get-key-string-configResult"><a href="#6-2-5-config-Get-key-string-configResult" class="headerlink" title="6.2.5 (*config) Get(key string) *configResult"></a>6.2.5 (*config) Get(key string) *configResult</h6><p>例如，要执行 <code>Get(&quot;database.master.host&quot;)</code>，执行流程为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">	A(开始) --&gt; B[在app.toml中检索database.master.host]</span><br><span class="line">  B --&gt; C&#123;是否存在?&#125;</span><br><span class="line">  C --存在--&gt; D(返回查询结果) </span><br><span class="line">	C --不存在--&gt; C1(在database.toml中搜索master.host)</span><br><span class="line">	D --&gt; E(结束)</span><br><span class="line">	C1 --&gt; D1&#123;是否存在?&#125;</span><br><span class="line">	D1 --存在--&gt; D</span><br><span class="line">	D1 --不存在--&gt; D2(返回空数据)</span><br><span class="line">	D2 --&gt; E</span><br></pre></td></tr></table></figure>

<br />

<h6 id="6-2-6-config-GetMulti-keys-…string-map-string-configResult"><a href="#6-2-6-config-GetMulti-keys-…string-map-string-configResult" class="headerlink" title="6.2.6 (*config) GetMulti(keys …string) map[string]*configResult"></a>6.2.6 (*config) GetMulti(keys …string) map[string]*configResult</h6><p>开始批处理查询。</p>
<br />

<h6 id="6-2-7-configResult-GetSearchKey-string"><a href="#6-2-7-configResult-GetSearchKey-string" class="headerlink" title="6.2.7 (*configResult) GetSearchKey() string"></a>6.2.7 (*configResult) GetSearchKey() string</h6><p>从结果集中获取结果查询使用的键。</p>
<br />

<h6 id="6-2-8-configResult-IsExists-bool"><a href="#6-2-8-configResult-IsExists-bool" class="headerlink" title="6.2.8 (*configResult) IsExists() bool"></a>6.2.8 (*configResult) IsExists() bool</h6><p>是否找到结果。</p>
<br />

<h6 id="6-2-9-configResult-RawData-data-interface"><a href="#6-2-9-configResult-RawData-data-interface" class="headerlink" title="6.2.9 (*configResult) RawData() (data interface{})"></a>6.2.9 (*configResult) RawData() (data interface{})</h6><p>获取interface{}类型的结果。</p>
<br />

<h6 id="6-2-10-configResult-ToString-data-string"><a href="#6-2-10-configResult-ToString-data-string" class="headerlink" title="6.2.10 (*configResult) ToString() (data string)"></a>6.2.10 (*configResult) ToString() (data string)</h6><p>获取字符串类型的结果。</p>
<br />

<h6 id="6-2-11-configResult-ToInt-data-int"><a href="#6-2-11-configResult-ToInt-data-int" class="headerlink" title="6.2.11 (*configResult) ToInt() (data int)"></a>6.2.11 (*configResult) ToInt() (data int)</h6><p>获得int类型的结果。</p>
<br />

<h6 id="6-2-12-configResult-ToBool-data-bool"><a href="#6-2-12-configResult-ToBool-data-bool" class="headerlink" title="6.2.12 (*configResult) ToBool() (data bool)"></a>6.2.12 (*configResult) ToBool() (data bool)</h6><p>获取bool类型的结果。</p>
<br />

<h6 id="6-2-13-configResult-ToIntSlice-data-int"><a href="#6-2-13-configResult-ToIntSlice-data-int" class="headerlink" title="6.2.13 (*configResult) ToIntSlice() (data []int)"></a>6.2.13 (*configResult) ToIntSlice() (data []int)</h6><p>获得int切片类型的结果。</p>
<br />

<h6 id="6-2-14-configResult-ToStringMap-data-map-string-interface"><a href="#6-2-14-configResult-ToStringMap-data-map-string-interface" class="headerlink" title="6.2.14 (*configResult) ToStringMap() (data map[string]interface{})"></a>6.2.14 (*configResult) ToStringMap() (data map[string]interface{})</h6><p>获取字符串映射类型的结果。</p>
<br />

<h6 id="6-2-15-configResult-ToStringMapString-data-map-string-string"><a href="#6-2-15-configResult-ToStringMapString-data-map-string-string" class="headerlink" title="6.2.15 (*configResult) ToStringMapString() (data map[string]string)"></a>6.2.15 (*configResult) ToStringMapString() (data map[string]string)</h6><p>获取字符串映射字符串类型的结果。</p>
<br />

<h6 id="6-2-16-configResult-ToStringMapStringSlice-data-map-string-string"><a href="#6-2-16-configResult-ToStringMapStringSlice-data-map-string-string" class="headerlink" title="6.2.16 (*configResult) ToStringMapStringSlice() (data map[string][]string)"></a>6.2.16 (*configResult) ToStringMapStringSlice() (data map[string][]string)</h6><p>获取字符串映射字符串切片类型的结果。</p>
<br />

<h6 id="6-2-17-configResult-ToStringSlice-data-string"><a href="#6-2-17-configResult-ToStringSlice-data-string" class="headerlink" title="6.2.17 (*configResult) ToStringSlice() (data []string)"></a>6.2.17 (*configResult) ToStringSlice() (data []string)</h6><p>获取字符串切片类型的结果。</p>
<br />

<h6 id="6-2-18-configResult-ToInt64-data-int64"><a href="#6-2-18-configResult-ToInt64-data-int64" class="headerlink" title="6.2.18 (*configResult) ToInt64() (data int64)"></a>6.2.18 (*configResult) ToInt64() (data int64)</h6><p>获取int64类型的结果。</p>
<br />

<h5 id="6-3-示例"><a href="#6-3-示例" class="headerlink" title="6.3 示例"></a>6.3 示例</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line"></span><br><span class="line">tdog.NewUtil().SetEnv(<span class="string">&quot;CONFIG_PATH&quot;</span>, <span class="string">&quot;/path/to/config/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取</span></span><br><span class="line">tdog.NewConfig().Get(<span class="string">&quot;app_port&quot;</span>).ToString() <span class="comment">// app.toml =&gt; app_port</span></span><br><span class="line">tdog.NewConfig().Get(<span class="string">&quot;database.master.port&quot;</span>).RawData().(<span class="keyword">string</span>) <span class="comment">// database.toml =&gt; [master] port</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 批量获取</span></span><br><span class="line">resultImpls := NewConfig().GetMulti(<span class="string">&quot;app_port&quot;</span>, <span class="string">&quot;database.master.port&quot;</span>, <span class="string">&quot;cache.port&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> _, resultImpl := <span class="keyword">range</span> resultImpls &#123;</span><br><span class="line">	fmt.Println(resultImpl.GetSearchKey(), resultImpl.IsExists(), resultImpl.ToString())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resultImpls =  NewConfig().SetFile(<span class="string">&quot;cache&quot;</span>).SetPrefix(<span class="string">&quot;master.&quot;</span>).GetMulti(<span class="string">&quot;host&quot;</span>, <span class="string">&quot;port&quot;</span>, <span class="string">&quot;pass&quot;</span>, <span class="string">&quot;pool_size&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> host, port, pass <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> poolSize <span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span> _, resultImpl := <span class="keyword">range</span> resultImpls &#123;</span><br><span class="line">	<span class="keyword">switch</span> resultImpl.GetSearchKey() &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;host&quot;</span>:</span><br><span class="line">		host = resultImpl.ToString()</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;port&quot;</span>:</span><br><span class="line">		port = resultImpl.ToString()</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;pass&quot;</span>:</span><br><span class="line">		pass = resultImpl.RawData().(<span class="keyword">string</span>)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">case</span> <span class="string">&quot;pool_size&quot;</span>:</span><br><span class="line">		poolSize = resultImpl.ToInt()</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>更多请随意探索。</p>
<br />

<h4 id="7-日志"><a href="#7-日志" class="headerlink" title="7. 日志"></a>7. 日志</h4><p>这是日志模块。用优步的ZAP取代ELK的想法最初是被激发出来的。</p>
<p>队列使用Redis，所以你应该先配置Redis的连接参数。</p>
<br />

<h5 id="7-1-结构"><a href="#7-1-结构" class="headerlink" title="7.1 结构"></a>7.1 结构</h5><p>模型结构是如此简单，似乎没有太多要说的。</p>
<br />

<h5 id="7-2-函数和使用"><a href="#7-2-函数和使用" class="headerlink" title="7.2 函数和使用"></a>7.2 函数和使用</h5><p>在Redis中，所有的日志都被写入一个指定的键。默认的密钥是 <code>log:list</code>。</p>
<br />

<h6 id="7-2-1-NewLogger-logger"><a href="#7-2-1-NewLogger-logger" class="headerlink" title="7.2.1 NewLogger() *logger"></a>7.2.1 NewLogger() *logger</h6><p>该函数用于初始化日志记录器结构，这是一切的起点和核心。</p>
<p>导入tdog后，此函数被用作 <code>tdog.NewLogger()</code></p>
<br />

<h6 id="7-2-2-logger-Error-message-string"><a href="#7-2-2-logger-Error-message-string" class="headerlink" title="7.2.2 (*logger) Error(message string)"></a>7.2.2 (*logger) Error(message string)</h6><p>将错误消息写入日志列表。</p>
<br />

<h6 id="7-2-3-logger-Warn-message-string"><a href="#7-2-3-logger-Warn-message-string" class="headerlink" title="7.2.3 (*logger) Warn(message string)"></a>7.2.3 (*logger) Warn(message string)</h6><p>将警告消息写入日志列表。</p>
<br />

<h6 id="7-2-4-logger-Info-message-string"><a href="#7-2-4-logger-Info-message-string" class="headerlink" title="7.2.4 (*logger) Info(message string)"></a>7.2.4 (*logger) Info(message string)</h6><p>将消息写入日志列表。</p>
<br />

<h5 id="7-3-示例"><a href="#7-3-示例" class="headerlink" title="7.3 示例"></a>7.3 示例</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/kisschou/tdog&quot;</span></span><br><span class="line"></span><br><span class="line">tdog.NewLogger().Error(<span class="string">&quot;This is a error message!&quot;</span>)</span><br><span class="line">tdog.NewLogger().Warn(<span class="string">&quot;This is a warn message!&quot;</span>)</span><br><span class="line">tdog.NewLogger().Info(<span class="string">&quot;This is a info message!&quot;</span>)</span><br><span class="line"></span><br><span class="line"># 推荐异步处理</span><br><span class="line"><span class="keyword">go</span> tdog.NewLogger().Error(<span class="string">&quot;This is a error message!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>以后我会对其进行关键修改。</p>
<br />

<h4 id="8-自动验证"><a href="#8-自动验证" class="headerlink" title="8. 自动验证"></a>8. 自动验证</h4><p>这是一个参数自动验证模块。</p>
<p>在一套规则下，快速、方便、自动根据规则对相应字段进行校准，并反馈校准结果。</p>
<p>所以，规则很重要。</p>
<br />

<h5 id="8-1-结构"><a href="#8-1-结构" class="headerlink" title="8.1 结构"></a>8.1 结构</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Rule <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name      <span class="keyword">string</span>   <span class="string">`json:&quot;name&quot;`</span>     <span class="comment">// 字段的名字</span></span><br><span class="line">	ParamType <span class="keyword">string</span>   <span class="string">`json:&quot;type&quot;`</span>     <span class="comment">// 字段的类型</span></span><br><span class="line">	IsMust    <span class="keyword">bool</span>     <span class="string">`json:&quot;is_must&quot;`</span>  <span class="comment">// 是否必须存在</span></span><br><span class="line">	Rule      []<span class="keyword">string</span> <span class="string">`json:&quot;validate&quot;`</span> <span class="comment">// 具体的验证规则</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Name</td>
<td>string</td>
<td>参数列表中查询的键名</td>
</tr>
<tr>
<td>ParamType</td>
<td>string</td>
<td>参数列表中查询的值类型</td>
</tr>
<tr>
<td>IsMust</td>
<td>bool</td>
<td>指定密钥名称必须存在于参数列表中</td>
</tr>
<tr>
<td>Rule</td>
<td>[]string</td>
<td>使用的验证规则可以在下面的规则描述部分中找到</td>
</tr>
</tbody></table>
<blockquote>
<p><code>IsMust</code> 优先于一切规则。所有规则都具有优先级，并按指定的顺序执行。</p>
</blockquote>
<br />

<h5 id="8-2-规则描述"><a href="#8-2-规则描述" class="headerlink" title="8.2 规则描述"></a>8.2 规则描述</h5><table>
<thead>
<tr>
<th>关键字</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>empty</td>
<td>确定该值是否为空。如果它是数字，则判断是否大于0。</td>
<td>-</td>
</tr>
<tr>
<td>phone</td>
<td>判断该值的内容是否为电话号码。目前只支持中国大陆手机号码</td>
<td>-</td>
</tr>
<tr>
<td>email</td>
<td>确定值的内容是否为邮箱地址</td>
<td>-</td>
</tr>
<tr>
<td>scope(x, y)</td>
<td>设置范围以指定字符串或数字的合理长度</td>
<td>scope(1,10)</td>
</tr>
<tr>
<td>enum(str1,str2,…)</td>
<td>设置枚举以约束值的内容</td>
<td>enum(header,body)</td>
</tr>
<tr>
<td>date</td>
<td>确认是否符合日期格式(yyyy-mm-dd)</td>
<td>-</td>
</tr>
<tr>
<td>datetime</td>
<td>检查该值是否符合 yyyy-mm-dd HH:MM:ss 的日期时间格式</td>
<td>-</td>
</tr>
<tr>
<td>sensitive-word</td>
<td>脱敏词列表检索内容是否包含敏感词。该项目暂时无效。</td>
<td>-</td>
</tr>
</tbody></table>
<blockquote>
<p>你可以同时选择多个规则来约束一个字段，例如’ []string{“ empty “， ‘email’， ‘scope(10，)’} ‘来指定一个同样满足条件的值:<br>· 不能是空的<br>· 正确的电子邮件地址<br>· 长度大于10</p>
</blockquote>
<blockquote>
<p>scope(x,y)规则可以同时设置x和y值，或者只能设置其中一个。当你设置x的值时，你添加了一个大于x的条件，对于y的值也是一样，当你设置它时，你添加了一个小于y的条件。</p>
</blockquote>
<br />

<h5 id="8-3-函数和使用"><a href="#8-3-函数和使用" class="headerlink" title="8.3 函数和使用"></a>8.3 函数和使用</h5><p>其实这里所说的都是一些显而易见的事情，只是怕久了，自己已经忘记了，所以记录下来。</p>
<br />

<h6 id="8-3-1-NewValidate"><a href="#8-3-1-NewValidate" class="headerlink" title="8.3.1 NewValidate()"></a>8.3.1 NewValidate()</h6><p>这个函数用于初始化验证结构，它是所有事情的起点和核心。</p>
<p>导入tdog后，此函数被用作 <code>tdog.NewValidate()</code></p>
<br />

<h6 id="8-3-2-validate-Rule-input-rule-validate"><a href="#8-3-2-validate-Rule-input-rule-validate" class="headerlink" title="8.3.2 (*validate) Rule(input []*rule) *validate"></a>8.3.2 (*validate) Rule(input []*rule) *validate</h6><p>这个函数主要用于注入一个规则列表。规则列表来自于 <code>Rule Struct</code>。</p>
<br />

<h6 id="8-3-3-validate-Json-input-string-validate"><a href="#8-3-3-validate-Json-input-string-validate" class="headerlink" title="8.3.3 (*validate) Json(input string) *validate"></a>8.3.3 (*validate) Json(input string) *validate</h6><p>这个函数也被用来注入一个规则列表，不同的是传递给这个函数的参数是 <code>json</code>。如果与<code>Rule</code>函数一起使用，后者将覆盖前者。</p>
<br />

<h6 id="8-3-4-validate-Check-needle-map-string-string-output-validReport-err-error"><a href="#8-3-4-validate-Check-needle-map-string-string-output-validReport-err-error" class="headerlink" title="8.3.4 (*validate) Check(needle map[string]string) (output *validReport, err error)"></a>8.3.4 (*validate) Check(needle map[string]string) (output *validReport, err error)</h6><p>开始验证并在任何数据失败时返回<code>Validate report</code>。</p>
<p>接收到的参数是<code>map[string]string</code>。这是上行数据的收集。如果涉及多维数组，则需要构建自己的循环处理。</p>
<p>返回的是一个<code>Validate report</code> 结构体和一个 <code>error</code>接口。错误需要你自己的判断来处理。这是戈朗的一个古老的东西。下面可以更详细地查看<code>Validate report</code>结构的使用。</p>
<br />


<h6 id="8-3-5-validate-UninterruptedCheck-needle-map-string-string-output-validReportCenter-err-error"><a href="#8-3-5-validate-UninterruptedCheck-needle-map-string-string-output-validReportCenter-err-error" class="headerlink" title="8.3.5 (*validate) UninterruptedCheck(needle map[string]string) (output *validReportCenter, err error)"></a>8.3.5 (*validate) UninterruptedCheck(needle map[string]string) (output *validReportCenter, err error)</h6><p>启动校验，无论它是否遇到有错误的对象，它都将顽固地坚持运行所有数据。</p>
<p>接收到的参数是 <code>map[string]string</code>。这是上行数据的收集。如果涉及多维数组，则需要构建自己的循环处理。</p>
<p>它将把所有的校验报告打包到 <code>Validate Report Center</code> 中并返回。校准报告中心的详细说明请看下面。它还返回一个需要自己处理的<code>error</code>接口。</p>
<br />

<h5 id="8-4-验证报告中心和验证报告"><a href="#8-4-验证报告中心和验证报告" class="headerlink" title="8.4 验证报告中心和验证报告"></a>8.4 验证报告中心和验证报告</h5><p>校验报告中心和校验报告这两个小东西</p>
<br />

<h6 id="8-4-1-验证报告"><a href="#8-4-1-验证报告" class="headerlink" title="8.4.1 验证报告"></a>8.4.1 验证报告</h6><p>这个结构没有子函数，但是它有一些参数可以使用:</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Name</td>
<td>string</td>
<td>参数列表中查询的键名</td>
</tr>
<tr>
<td>Rule</td>
<td>[]string</td>
<td>使用的验证规则可以在下面的规则描述部分中找到</td>
</tr>
<tr>
<td>Result</td>
<td>bool</td>
<td>验证的结果，<code>True</code> 表示验证成功，<code>False</code> 表示验证失败</td>
</tr>
<tr>
<td>Message</td>
<td>string</td>
<td>验证结果的短信反馈目前只固定为中文，不支持自定义。如有必要，您可以根据<code>Result</code>字段自行处理。</td>
</tr>
<tr>
<td>Val</td>
<td>interface{}</td>
<td>验证结果的短信反馈目前只固定为中文，不支持自定义。如有必要，您可以根据<code>Result</code>字段自行处理。</td>
</tr>
</tbody></table>
<blockquote>
<p>您可以直接使用这些参数。</p>
<p>如果经过一轮检查，发现所有都通过了验证，此时将返回一个报告结构，其Name和Rule为空，Result为True, Message为Success。<br>因此，如果您看到一个类似的验证报告，这可以继续下面的过程。</p>
</blockquote>
<br />

<h6 id="8-4-2-验证报告中心"><a href="#8-4-2-验证报告中心" class="headerlink" title="8.4.2 验证报告中心"></a>8.4.2 验证报告中心</h6><ul>
<li><p>(*validReportCenter) ReportList() []*validReport </p>
<blockquote>
<p>从报告中心获取所有报告。</p>
</blockquote>
</li>
<li><p>(*validReportCenter) ReportByIndex(index int) *validReport</p>
<blockquote>
<p>通过索引获取报告。给定int index，返回 <code>*report</code></p>
</blockquote>
</li>
<li><p>(*validReportCenter) ReportByName(name string) *validReport</p>
<blockquote>
<p>按名称获取报告。因此必须给定字符串名称，并将返回 <code>*report</code></p>
</blockquote>
</li>
<li><p>(*validReportCenter) CheckSuccess(inputs …string) (isAllSuccess bool, failList []*validReport)</p>
<blockquote>
<p>接受所有传入的键, 依次判断校验结果是否成功,<br>isAllSuccess : 校验结果, <code>true</code> 表示全部成功<br>failList : 失败的结果集合</p>
</blockquote>
</li>
<li><p>(*validReportCenter) BuildTime() string</p>
<blockquote>
<p>从报告中心获得构建时间。</p>
</blockquote>
</li>
<li><p>(*validReportCenter) ElapsedTime() int64</p>
<blockquote>
<p>从报表中心获取运行时间。返回值为纳秒。</p>
</blockquote>
</li>
<li><p>(*validReportCenter) ToJson() string</p>
<blockquote>
<p>转换为json并返回。</p>
</blockquote>
<br /></li>
</ul>
<h2 id="贡献"><a href="#贡献" class="headerlink" title="贡献"></a>贡献</h2><p>让我们一起享受美好时光!!</p>
<ul>
<li>Fork the Project</li>
<li>创建属于你的分支 (git checkout -b feature/AmazingFeature)</li>
<li>提交你的修改 (git commit -m ‘Add some AmazingFeature’)</li>
<li>推送到分支 (git push origin feature/AmazingFeature)</li>
<li>Open a Pull Request</li>
</ul>
<br />


<h2 id="Licence"><a href="#Licence" class="headerlink" title="Licence"></a>Licence</h2><p>Copyright (c) 2020-present Kisschou.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Kisschou</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kisschou.github.io/2021/05/17/tdog/">https://kisschou.github.io/2021/05/17/tdog/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kisschou.github.io" target="_blank">男孩的迷宫</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/golang/">golang</a></div><div class="post_share"><div class="social-share" data-image="https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=650&amp;w=940" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2021/05/17/tdog-en/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=650&amp;w=940" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">About a little thing called tdog</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/05/17/tdog-en/" title="About a little thing called tdog"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-18</div><div class="title">About a little thing called tdog</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://avatars.githubusercontent.com/u/996082?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Kisschou</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">2</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/kisschou"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E4%BD%BF%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">快速使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%9D%A5%E8%B5%B7%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.0.1.</span> <span class="toc-text">用来起服务:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%93%E8%84%9A%E6%89%8B%E6%9E%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">3.0.2.</span> <span class="toc-text">当脚手架使用:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BB%AC"><span class="toc-number">4.</span> <span class="toc-text">函数们</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-MySQL"><span class="toc-number">4.0.1.</span> <span class="toc-text">1. MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-%E7%BB%93%E6%9E%84"><span class="toc-number">4.0.1.1.</span> <span class="toc-text">1.1 结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-NewMySQL-mySql"><span class="toc-number">4.0.1.2.</span> <span class="toc-text">1.2 NewMySQL() *mySql</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-3-mySql-Change-name-string-xorm-Engine"><span class="toc-number">4.0.1.3.</span> <span class="toc-text">1.3 (*mySql) Change(name string) *xorm.Engine</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-mySql-New-name-string-conf-MySqlConf-xorm-Engine"><span class="toc-number">4.0.1.4.</span> <span class="toc-text">1.4 (*mySql) New(name string, conf *MySqlConf) *xorm.Engine</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-5-Example"><span class="toc-number">4.0.1.5.</span> <span class="toc-text">1.5 Example</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Redis"><span class="toc-number">4.0.2.</span> <span class="toc-text">2. Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-%E7%BB%93%E6%9E%84-1"><span class="toc-number">4.0.2.1.</span> <span class="toc-text">1.1 结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-%E5%87%BD%E6%95%B0%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.2.2.</span> <span class="toc-text">1.2 函数和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-2-1-NewRedis-redisModel"><span class="toc-number">4.0.2.2.1.</span> <span class="toc-text">1.2.1 NewRedis() *redisModel</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#1-2-2-redisModel-Change-name-string-redisImpl-Client"><span class="toc-number">4.0.2.2.2.</span> <span class="toc-text">1.2.2 (*redisModel) Change(name string) *redisImpl.Client</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#1-2-3-redisModel-New-name-host-port-pass-string-poolSize-int-redisImpl-Client"><span class="toc-number">4.0.2.2.3.</span> <span class="toc-text">1.2.3 (*redisModel) New(name, host, port, pass string, poolSize int) *redisImpl.Client</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#1-2-4-redisModel-Db-index-int-redisImpl-Client"><span class="toc-number">4.0.2.2.4.</span> <span class="toc-text">1.2.4 (*redisModel) Db(index int) *redisImpl.Client</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-3-%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.0.2.3.</span> <span class="toc-text">1.3 示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%B7%A5%E5%85%B7"><span class="toc-number">4.0.3.</span> <span class="toc-text">3. 工具</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-%E7%BB%93%E6%9E%84"><span class="toc-number">4.0.3.1.</span> <span class="toc-text">3.1 结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-%E5%87%BD%E6%95%B0%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.3.2.</span> <span class="toc-text">3.2 函数和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-1-NewUtil-util"><span class="toc-number">4.0.3.2.1.</span> <span class="toc-text">3.2.1 NewUtil() *util</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-2-util-GetFilesBySuffix-filePath-string-suffix-string-files-string-err-error"><span class="toc-number">4.0.3.2.2.</span> <span class="toc-text">3.2.2 (*util) GetFilesBySuffix(filePath string, suffix string) (files []string, err error)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-3-util-FileExists-path-string-bool"><span class="toc-number">4.0.3.2.3.</span> <span class="toc-text">3.2.3 (*util) FileExists(path string) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-4-util-IsDir-path-string-bool"><span class="toc-number">4.0.3.2.4.</span> <span class="toc-text">3.2.4 (*util) IsDir(path string) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-5-util-IsFile-path-string"><span class="toc-number">4.0.3.2.5.</span> <span class="toc-text">3.2.5 (*util) IsFile(path string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-6-util-DirExistsAndCreate-path-string"><span class="toc-number">4.0.3.2.6.</span> <span class="toc-text">3.2.6 (*util) DirExistsAndCreate(path string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-7-util-RandomStr-length-int-randType-%E2%80%A6int-string"><span class="toc-number">4.0.3.2.7.</span> <span class="toc-text">3.2.7 (*util) RandomStr(length int, randType …int) string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-8-util-RandInt64-min-max-int64-int64"><span class="toc-number">4.0.3.2.8.</span> <span class="toc-text">3.2.8 (*util) RandInt64(min, max int64) int64</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-9-util-InArray-dataType-string-input-needle-interface-bool"><span class="toc-number">4.0.3.2.9.</span> <span class="toc-text">3.2.9 (*util) InArray(dataType string, input, needle interface{}) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-10-util-Isset-dataType-string-input-needle-interface-bool"><span class="toc-number">4.0.3.2.10.</span> <span class="toc-text">3.2.10 (*util) Isset(dataType string, input, needle interface{}) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-11-util-Empty-dataType-string-input-needle-interface-bool"><span class="toc-number">4.0.3.2.11.</span> <span class="toc-text">3.2.11 (*util) Empty(dataType string, input, needle interface{}) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-12-util-ArrayUnique-dataType-string-input-interface-interface"><span class="toc-number">4.0.3.2.12.</span> <span class="toc-text">3.2.12 (*util) ArrayUnique(dataType string, input interface{}) interface{}</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-13-util-ArrayMerge-dataType-string-list-%E2%80%A6interface-interface"><span class="toc-number">4.0.3.2.13.</span> <span class="toc-text">3.2.13 (*util) ArrayMerge(dataType string, list …interface{}) interface{}</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-14-util-Remove-dataType-string-slice-interface-index-int-interface"><span class="toc-number">4.0.3.2.14.</span> <span class="toc-text">3.2.14 (*util) Remove(dataType string, slice interface{}, index int) interface{}</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-15-util-VerifyEmail-email-string-bool"><span class="toc-number">4.0.3.2.15.</span> <span class="toc-text">3.2.15 (*util) VerifyEmail(email string) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-16-util-VerifyPhone-phone-string-bool"><span class="toc-number">4.0.3.2.16.</span> <span class="toc-text">3.2.16 (*util) VerifyPhone(phone string) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-17-util-VerifyDate-input-string-bool"><span class="toc-number">4.0.3.2.17.</span> <span class="toc-text">3.2.17 (*util) VerifyDate(input string) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-18-util-VerifyDateTime-input-string-bool"><span class="toc-number">4.0.3.2.18.</span> <span class="toc-text">3.2.18 (*util) VerifyDateTime(input string) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-19-util-GetMachineId-int64"><span class="toc-number">4.0.3.2.19.</span> <span class="toc-text">3.2.19 (*util) GetMachineId() int64</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-20-util-StructToMap-obj-interface-map-string-interface"><span class="toc-number">4.0.3.2.20.</span> <span class="toc-text">3.2.20 (*util) StructToMap(obj interface{}) map[string]interface{}</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-21-util-UrlSplit-url-string-protocol-domain-string-port-int"><span class="toc-number">4.0.3.2.21.</span> <span class="toc-text">3.2.21 (*util) UrlSplit(url string) (protocol, domain string, port int)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-22-util-UrlJoint-protocol-domain-string-port-int-url-string"><span class="toc-number">4.0.3.2.22.</span> <span class="toc-text">3.2.22 (*util) UrlJoint(protocol, domain string, port int) (url string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-23-util-SnakeString-s-string-string"><span class="toc-number">4.0.3.2.23.</span> <span class="toc-text">3.2.23 (*util) SnakeString(s string) string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-24-util-CamelString-s-string-string"><span class="toc-number">4.0.3.2.24.</span> <span class="toc-text">3.2.24 (*util) CamelString(s string) string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-25-util-UcFirst-s-string-string"><span class="toc-number">4.0.3.2.25.</span> <span class="toc-text">3.2.25 (*util) UcFirst(s string) string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-26-util-checkPortAlived-port-int-bool"><span class="toc-number">4.0.3.2.26.</span> <span class="toc-text">3.2.26 (*util) checkPortAlived(port int) bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-26-util-GetPidByPort-port-int-int"><span class="toc-number">4.0.3.2.27.</span> <span class="toc-text">3.2.26 (*util) GetPidByPort(port int) int</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-27-util-SetEnv-key-interface-value-string-error"><span class="toc-number">4.0.3.2.28.</span> <span class="toc-text">3.2.27 (*util) SetEnv(key interface{}, value string) error</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-28-util-GetEnv-keys-%E2%80%A6string-map-string-string"><span class="toc-number">4.0.3.2.29.</span> <span class="toc-text">3.2.28 (*util) GetEnv(keys …string) map[string]string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-29-Recover"><span class="toc-number">4.0.3.2.30.</span> <span class="toc-text">3.2.29 Recover()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#3-2-30-Monitor-err-error"><span class="toc-number">4.0.3.2.31.</span> <span class="toc-text">3.2.30 Monitor() (err error)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3-%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.0.3.3.</span> <span class="toc-text">3.3 示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%8A%A0%E5%AF%86"><span class="toc-number">4.0.4.</span> <span class="toc-text">4. 加密</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-%E7%BB%93%E6%9E%84"><span class="toc-number">4.0.4.1.</span> <span class="toc-text">4.1 结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2-%E5%87%BD%E6%95%B0%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.4.2.</span> <span class="toc-text">4.2 函数和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-1-NewCrypt-input-string-crypt"><span class="toc-number">4.0.4.2.1.</span> <span class="toc-text">4.2.1 NewCrypt(input string) *crypt</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-2-crypt-Md5-string"><span class="toc-number">4.0.4.2.2.</span> <span class="toc-text">4.2.2 (*crypt) Md5() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-3-crypt-Sha1-string"><span class="toc-number">4.0.4.2.3.</span> <span class="toc-text">4.2.3 (*crypt) Sha1() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-4-crypt-Sha256-string"><span class="toc-number">4.0.4.2.4.</span> <span class="toc-text">4.2.4 (*crypt) Sha256() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-5-crypt-Sha512"><span class="toc-number">4.0.4.2.5.</span> <span class="toc-text">4.2.5 (*crypt) Sha512()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-6-crypt-Crc32-string"><span class="toc-number">4.0.4.2.6.</span> <span class="toc-text">4.2.6 (*crypt) Crc32() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-7-crypt-Base64Encode-string"><span class="toc-number">4.0.4.2.7.</span> <span class="toc-text">4.2.7 (*crypt) Base64Encode() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-8-crypt-Base64Decode-string"><span class="toc-number">4.0.4.2.8.</span> <span class="toc-text">4.2.8 (*crypt) Base64Decode() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-9-crypt-UrlBase64Encode-string"><span class="toc-number">4.0.4.2.9.</span> <span class="toc-text">4.2.9 (*crypt) UrlBase64Encode() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-10-crypt-UrlBase64Decode-string"><span class="toc-number">4.0.4.2.10.</span> <span class="toc-text">4.2.10 (*crypt) UrlBase64Decode() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-11-crypt-Urlencode-string"><span class="toc-number">4.0.4.2.11.</span> <span class="toc-text">4.2.11 (*crypt) Urlencode() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-12-crypt-Urldecode-string"><span class="toc-number">4.0.4.2.12.</span> <span class="toc-text">4.2.12 (*crypt) Urldecode() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-13-crypt-BiuPwdNewBuilder-password-string-salt-string-newPassword-string"><span class="toc-number">4.0.4.2.13.</span> <span class="toc-text">4.2.13 (*crypt) BiuPwdNewBuilder(password string) (salt string, newPassword string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-14-crypt-BiuPwdBuilder-salt-string-password-string-newPassword-string"><span class="toc-number">4.0.4.2.14.</span> <span class="toc-text">4.2.14 (*crypt) BiuPwdBuilder(salt string, password string) (newPassword string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-15-crypt-GenerateRsaKey-bits-int-publicKey-privateKey-string"><span class="toc-number">4.0.4.2.15.</span> <span class="toc-text">4.2.15 (*crypt) GenerateRsaKey(bits int) (publicKey, privateKey string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-16-crypt-RsaPubEncode-pubKey-string-string"><span class="toc-number">4.0.4.2.16.</span> <span class="toc-text">4.2.16 (*crypt) RsaPubEncode(pubKey string) string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-17-crypt-RsaPriDecode-priKey-string-string"><span class="toc-number">4.0.4.2.17.</span> <span class="toc-text">4.2.17 (*crypt) RsaPriDecode(priKey string) string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-18-crypt-RsaPriEncode-priKey-string-string"><span class="toc-number">4.0.4.2.18.</span> <span class="toc-text">4.2.18 (*crypt) RsaPriEncode(priKey string) string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-2-19-crypt-RsaPubDecode-pubKey-string-string"><span class="toc-number">4.0.4.2.19.</span> <span class="toc-text">4.2.19 (*crypt) RsaPubDecode(pubKey string) string</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.0.4.3.</span> <span class="toc-text">4.3 示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Excel"><span class="toc-number">4.0.5.</span> <span class="toc-text">5. Excel</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-%E5%87%BD%E6%95%B0%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.5.1.</span> <span class="toc-text">5.1 函数和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#5-1-1-NewExcel-file-string-excel"><span class="toc-number">4.0.5.1.1.</span> <span class="toc-text">5.1.1 NewExcel(file string) *excel</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-1-2-excel-Get-string"><span class="toc-number">4.0.5.1.2.</span> <span class="toc-text">5.1.2 ( *excel) Get() [][][]string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-1-3-excel-Open-excelImpl-xlsx-File"><span class="toc-number">4.0.5.1.3.</span> <span class="toc-text">5.1.3 (*excel) Open() (excelImpl *xlsx.File)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E9%85%8D%E7%BD%AE"><span class="toc-number">4.0.6.</span> <span class="toc-text">6. 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#6-1-%E7%BB%93%E6%9E%84"><span class="toc-number">4.0.6.1.</span> <span class="toc-text">6.1 结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-2-%E5%87%BD%E6%95%B0%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.6.2.</span> <span class="toc-text">6.2 函数和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-1-NewConfig-config"><span class="toc-number">4.0.6.2.1.</span> <span class="toc-text">6.2.1 NewConfig() *config</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-2-config-SetPath-path-string-config"><span class="toc-number">4.0.6.2.2.</span> <span class="toc-text">6.2.2 (*config) SetPath(path string) *config</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-3-config-SetFile-name-string-config"><span class="toc-number">4.0.6.2.3.</span> <span class="toc-text">6.2.3 (*config) SetFile(name string) *config</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-4-config-SetPrefix-prefix-string-config"><span class="toc-number">4.0.6.2.4.</span> <span class="toc-text">6.2.4 (*config) SetPrefix(prefix string) *config</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-5-config-Get-key-string-configResult"><span class="toc-number">4.0.6.2.5.</span> <span class="toc-text">6.2.5 (*config) Get(key string) *configResult</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-6-config-GetMulti-keys-%E2%80%A6string-map-string-configResult"><span class="toc-number">4.0.6.2.6.</span> <span class="toc-text">6.2.6 (*config) GetMulti(keys …string) map[string]*configResult</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-7-configResult-GetSearchKey-string"><span class="toc-number">4.0.6.2.7.</span> <span class="toc-text">6.2.7 (*configResult) GetSearchKey() string</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-8-configResult-IsExists-bool"><span class="toc-number">4.0.6.2.8.</span> <span class="toc-text">6.2.8 (*configResult) IsExists() bool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-9-configResult-RawData-data-interface"><span class="toc-number">4.0.6.2.9.</span> <span class="toc-text">6.2.9 (*configResult) RawData() (data interface{})</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-10-configResult-ToString-data-string"><span class="toc-number">4.0.6.2.10.</span> <span class="toc-text">6.2.10 (*configResult) ToString() (data string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-11-configResult-ToInt-data-int"><span class="toc-number">4.0.6.2.11.</span> <span class="toc-text">6.2.11 (*configResult) ToInt() (data int)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-12-configResult-ToBool-data-bool"><span class="toc-number">4.0.6.2.12.</span> <span class="toc-text">6.2.12 (*configResult) ToBool() (data bool)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-13-configResult-ToIntSlice-data-int"><span class="toc-number">4.0.6.2.13.</span> <span class="toc-text">6.2.13 (*configResult) ToIntSlice() (data []int)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-14-configResult-ToStringMap-data-map-string-interface"><span class="toc-number">4.0.6.2.14.</span> <span class="toc-text">6.2.14 (*configResult) ToStringMap() (data map[string]interface{})</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-15-configResult-ToStringMapString-data-map-string-string"><span class="toc-number">4.0.6.2.15.</span> <span class="toc-text">6.2.15 (*configResult) ToStringMapString() (data map[string]string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-16-configResult-ToStringMapStringSlice-data-map-string-string"><span class="toc-number">4.0.6.2.16.</span> <span class="toc-text">6.2.16 (*configResult) ToStringMapStringSlice() (data map[string][]string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-17-configResult-ToStringSlice-data-string"><span class="toc-number">4.0.6.2.17.</span> <span class="toc-text">6.2.17 (*configResult) ToStringSlice() (data []string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#6-2-18-configResult-ToInt64-data-int64"><span class="toc-number">4.0.6.2.18.</span> <span class="toc-text">6.2.18 (*configResult) ToInt64() (data int64)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-3-%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.0.6.3.</span> <span class="toc-text">6.3 示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%97%A5%E5%BF%97"><span class="toc-number">4.0.7.</span> <span class="toc-text">7. 日志</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#7-1-%E7%BB%93%E6%9E%84"><span class="toc-number">4.0.7.1.</span> <span class="toc-text">7.1 结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-2-%E5%87%BD%E6%95%B0%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.7.2.</span> <span class="toc-text">7.2 函数和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#7-2-1-NewLogger-logger"><span class="toc-number">4.0.7.2.1.</span> <span class="toc-text">7.2.1 NewLogger() *logger</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-2-2-logger-Error-message-string"><span class="toc-number">4.0.7.2.2.</span> <span class="toc-text">7.2.2 (*logger) Error(message string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-2-3-logger-Warn-message-string"><span class="toc-number">4.0.7.2.3.</span> <span class="toc-text">7.2.3 (*logger) Warn(message string)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#7-2-4-logger-Info-message-string"><span class="toc-number">4.0.7.2.4.</span> <span class="toc-text">7.2.4 (*logger) Info(message string)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-3-%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.0.7.3.</span> <span class="toc-text">7.3 示例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E8%87%AA%E5%8A%A8%E9%AA%8C%E8%AF%81"><span class="toc-number">4.0.8.</span> <span class="toc-text">8. 自动验证</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#8-1-%E7%BB%93%E6%9E%84"><span class="toc-number">4.0.8.1.</span> <span class="toc-text">8.1 结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-2-%E8%A7%84%E5%88%99%E6%8F%8F%E8%BF%B0"><span class="toc-number">4.0.8.2.</span> <span class="toc-text">8.2 规则描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-3-%E5%87%BD%E6%95%B0%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.0.8.3.</span> <span class="toc-text">8.3 函数和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#8-3-1-NewValidate"><span class="toc-number">4.0.8.3.1.</span> <span class="toc-text">8.3.1 NewValidate()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-3-2-validate-Rule-input-rule-validate"><span class="toc-number">4.0.8.3.2.</span> <span class="toc-text">8.3.2 (*validate) Rule(input []*rule) *validate</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-3-3-validate-Json-input-string-validate"><span class="toc-number">4.0.8.3.3.</span> <span class="toc-text">8.3.3 (*validate) Json(input string) *validate</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-3-4-validate-Check-needle-map-string-string-output-validReport-err-error"><span class="toc-number">4.0.8.3.4.</span> <span class="toc-text">8.3.4 (*validate) Check(needle map[string]string) (output *validReport, err error)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-3-5-validate-UninterruptedCheck-needle-map-string-string-output-validReportCenter-err-error"><span class="toc-number">4.0.8.3.5.</span> <span class="toc-text">8.3.5 (*validate) UninterruptedCheck(needle map[string]string) (output *validReportCenter, err error)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-4-%E9%AA%8C%E8%AF%81%E6%8A%A5%E5%91%8A%E4%B8%AD%E5%BF%83%E5%92%8C%E9%AA%8C%E8%AF%81%E6%8A%A5%E5%91%8A"><span class="toc-number">4.0.8.4.</span> <span class="toc-text">8.4 验证报告中心和验证报告</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#8-4-1-%E9%AA%8C%E8%AF%81%E6%8A%A5%E5%91%8A"><span class="toc-number">4.0.8.4.1.</span> <span class="toc-text">8.4.1 验证报告</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#8-4-2-%E9%AA%8C%E8%AF%81%E6%8A%A5%E5%91%8A%E4%B8%AD%E5%BF%83"><span class="toc-number">4.0.8.4.2.</span> <span class="toc-text">8.4.2 验证报告中心</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A1%E7%8C%AE"><span class="toc-number">5.</span> <span class="toc-text">贡献</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Licence"><span class="toc-number">6.</span> <span class="toc-text">Licence</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/05/17/tdog-en/" title="About a little thing called tdog"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=650&amp;w=940" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="About a little thing called tdog"/></a><div class="content"><a class="title" href="/2021/05/17/tdog-en/" title="About a little thing called tdog">About a little thing called tdog</a><time datetime="2021-05-17T19:37:24.000Z" title="发表于 2021-05-18 03:37:24">2021-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/17/tdog/" title="关于一个叫做tdog的小东西"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://images.pexels.com/photos/546819/pexels-photo-546819.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=650&amp;w=940" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="关于一个叫做tdog的小东西"/></a><div class="content"><a class="title" href="/2021/05/17/tdog/" title="关于一个叫做tdog的小东西">关于一个叫做tdog的小东西</a><time datetime="2021-05-17T19:18:51.000Z" title="发表于 2021-05-18 03:18:51">2021-05-18</time></div></div></div></div></div></div></main><footer id="footer" style="background: #afc3cf"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Kisschou</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>